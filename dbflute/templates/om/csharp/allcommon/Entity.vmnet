
using System;
using System.Collections.Generic;

using ${glPackageBaseCommonDBMeta};

namespace ${glPackageBaseCommon} {

    /// <summary>
    /// The interface of entity.
    /// Author: ${database.ClassAuthor}
    /// </summary>
    public interface ${glEntityInterfaceName} {

        // ===============================================================================
        //                                                                      Table Name
        //                                                                      ==========
        /// <summary>
        /// The property of table db-name. (readonly)
        /// </summary>
        String TableDbName { get; }

        /// <summary>
        /// The property of table property-name. (readonly)
        /// </summary>
        String TablePropertyName { get; }

        // ===============================================================================
        //                                                                          DBMeta
        //                                                                          ======
        /// <summary>
        /// The property of DBMeta. (readonly)
        /// </summary>
        ${glDBMetaInterfaceName} DBMeta { get; }

        // ===============================================================================
        //                                                                   Determination
        //                                                                   =============
        /// <summary>
        /// Has primary-key value? (readonly)
        /// </summary>
        bool HasPrimaryKeyValue { get; }
    }

    /// <summary>
    /// The modified properties of entity.
    /// Author: ${database.ClassAuthor}
    /// </summary>
    public class EntityModifiedProperties {

        // ===============================================================================
        //                                                                       Attribute
        //                                                                       =========
        protected IDictionary<String, Object> _propertiesSet = new Dictionary<String, Object>();

        // ===============================================================================
        //                                                                             Add
        //                                                                             ===
        public void AddPropertyName(String propertyName) {
            if (_propertiesSet.ContainsKey(propertyName)) {
                return;
            }
            _propertiesSet.Add(propertyName, null);
        }

        public void AddPropertyNameIfNeeds(String propertyName, Object before, Object after) {
            if (_propertiesSet.ContainsKey(propertyName)) {
                return;
            }
            if (before == null || !before.Equals(after)) {
                AddPropertyName(propertyName);
            }
        }

        // ===============================================================================
        //                                                                           Other
        //                                                                           =====
        public void Clear() {
            _propertiesSet.Clear();
        }

        public void Remove(String propertyName) {
            _propertiesSet.Remove(propertyName);
        }

        // ===============================================================================
        //                                                                        Accessor
        //                                                                        ========
        public IDictionary<String, Object> PropertyNames {
            get { return _propertiesSet; }
        }

    }
}
