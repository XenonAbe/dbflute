${database.allClassCopyright}package ${glPackageBaseCommonS2Dao};

import org.seasar.extension.jdbc.SqlLog;
import org.seasar.extension.jdbc.SqlLogRegistry;
import org.seasar.extension.jdbc.SqlLogRegistryLocator;

import ${glPackageBaseCommonJdbc}.${glLatestSqlProviderName};

/**
 * The provider of latest SQL as S2Dao. <br />
 * This instance should be singleton. <br />
 * 
 * @author ${database.ClassAuthor}
 */
public class ${glDaoLatestSqlProvider} implements ${glLatestSqlProviderName} {

    /**
     * The implementation.
     * 
     * @return Display SQL. (Nullable: If it was not found, returns null.)
     */
    public String getDisplaySql() {
        return getLastCompleteSql();
    }

    private String getLastCompleteSql() {
        try {
            final SqlLogRegistry registry = SqlLogRegistryLocator.getInstance();
            if (registry == null) {
                return null;
            }
            final SqlLog lastSqlLog = registry.getLast();
            if (lastSqlLog == null) {
                return null;
            }
            final String completeSql = lastSqlLog.getCompleteSql();
            if (completeSql == null || completeSql.trim().length() == 0) {
                return null;
            }
            return completeSql;
        } catch (RuntimeException ignored) {
            return null;
        }
    }
}
