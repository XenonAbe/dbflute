<project name="DBFlute" default="dist" basedir=".">

  <!-- ================================================================ -->
  <!-- G E N E R A T E   D I S T R I B U T I O N                        -->
  <!-- ================================================================ -->
  <property name="version" value="0.8.7-393"/>
  <property name="deploy.base" value="../../dbflute"/>
  <property name="workspace.base" value=".."/>

  <property name="dbflute.jar.file" value="dbflute.jar"/>
  <property name="dbflute.jar.dirfile" value="dist/${dbflute.jar.file}"/>
  <property name="dbflute.zip.file" value="dbflute-${version}.zip"/>
  <property name="dbflute.zip.dirfile" value="dist/${dbflute.zip.file}"/>
  <property name="dbflute.deploy.dir" value="${deploy.base}/dbflute-${version}"/>
  <property name="dbflute.ncsharp.dir" value="${workspace.base}/dfncsharp"/>
  <property name="dbflute.basic.example.dir" value="${workspace.base}/dbflute-basic-example"/>
  <property name="dbflute.oracle.example.dir" value="${workspace.base}/dbflute-oracle-example"/>
  <property name="dbflute.postgresql.example.dir" value="${workspace.base}/dbflute-postgresql-example"/>
  <property name="dbflute.mysql.example.dir" value="${workspace.base}/dbflute-mysql-example"/>
  <property name="dbflute.db2.example.dir" value="${workspace.base}/dbflute-db2-example"/>
  <property name="dbflute.sqlserver.example.dir" value="${workspace.base}/dbflute-sqlserver-example"/>
  <property name="dbflute.msaccess.example.dir" value="${workspace.base}/dbflute-msaccess-example"/>
  <property name="dbflute.spring.example.dir" value="${workspace.base}/dbflute-spring-example"/>
  <property name="dbflute.teeda.example.dir" value="${workspace.base}/dbflute-teeda-example"/>
  <property name="dbflute.ymir.example.dir" value="${workspace.base}/dbflute-ymir-example"/>
  <property name="dbflute.sastruts.example.dir" value="${workspace.base}/dbflute-sastruts-example"/>
  <property name="dbflute.buri.example.dir" value="${workspace.base}/dbflute-buri-example"/>
  <property name="dbflute.s2jdbc.example.dir" value="${workspace.base}/dbflute-s2jdbc-example"/>
  <property name="dbflute.flexserver.example.dir" value="${workspace.base}/dbflute-flexserver-example"/>
  <property name="dbflute.multipledb.example.dir" value="${workspace.base}/dbflute-multipledb-example"/>
  <property name="dbflute.nbasic.example.dir" value="${workspace.base}/dbflute-nbasic-example"/>
  <property name="dbflute.noracle.example.dir" value="${workspace.base}/dbflute-noracle-example"/>
  <property name="dbflute.pbasic.example.dir" value="${workspace.base}/dbflute-pbasic-example"/>

  <target name="clean">
    <delete dir="target/classes"/>
    <mkdir dir="target/classes"/>
  </target>
  
  <target name="copy-resources">
    <copy todir="target/classes">
      <fileset dir="src/main/java">
        <exclude name="**/*.java"/>
      </fileset>
      <fileset dir="src/main/resources">
        <exclude name="**/*.java"/>
      </fileset>
    </copy>
  </target>

  <target name="compile" depends="clean, copy-resources" description="==> compiles sources">

    <echo message="+------------------------------------------+"/>
    <echo message="|                                          |"/>
    <echo message="| Compiling sources!                       |"/>
    <echo message="|                                          |"/>
    <echo message="+------------------------------------------+"/>

  	<javac destdir="target/classes" encoding="UTF-8" debug="true">
      <src path="src/main/java" />
  	  <src path="src/main/resources" />
      <classpath>
        <fileset dir="lib/forCompile">
          <include name="**/*.jar" />
        </fileset>
      </classpath>
  	  <include name="**/*"/>
  	  <compilerarg value="-Xlint:deprecation" />
  	  <compilerarg value="-Xlint:unchecked" />
  	</javac>
  </target>

  <target name="dist" depends="compile" description="==> generates distribution">

    <echo message="+------------------------------------------+"/>
    <echo message="|                                          |"/>
    <echo message="| Generating dist for YOUR datamodel!      |"/>
    <echo message="|                                          |"/>
    <echo message="+------------------------------------------+"/>

    <mkdir dir="dist"/>
    <delete file="${dbflute.jar.dirfile}"/>
    <jar jarfile="${dbflute.jar.dirfile}" basedir="target/classes"></jar>
    <delete file="${dbflute.zip.dirfile}"/>
    <zip zipfile="${dbflute.zip.dirfile}">
        <zipfileset prefix="etc/cmd" dir="etc/cmd">
            <include name="*.cmd"/>
            <include name="*.sh"/>
        </zipfileset>
        <zipfileset prefix="etc/client_directory-template" dir="etc/client_directory-template"/>
        <zipfileset prefix="lib/forExecute" dir="dist">
            <include name="${dbflute.jar.file}"/>
        </zipfileset>
        <zipfileset prefix="lib/forExecute" dir="lib/forExecute">
            <include name="*.jar"/>
            <include name="*.zip"/>
        </zipfileset>
        <zipfileset prefix="log" dir="log">
            <include name="readme.txt"/>
        </zipfileset>
        <zipfileset prefix="output/doc" dir="output/doc">
            <include name="readme.txt"/>
        </zipfileset>
        <zipfileset prefix="schema" dir="schema">
            <include name="readme.txt"/>
        </zipfileset>
        <zipfileset prefix="templates" dir="templates">
            <exclude name="**/*---.txt"/>
        </zipfileset>
        <zipfileset prefix="ant" dir="ant"/>
        <zipfileset prefix="" dir="">
            <include name="build-torque.xml"/>
        </zipfileset>
    </zip>
  </target>

  <target name="expand-dist">
    <delete dir="${dbflute.deploy.dir}"/>
    <unzip src="${dbflute.zip.dirfile}" dest="${dbflute.deploy.dir}"/>
  	<chmod dir="${dbflute.deploy.dir}/ant/bin" perm="ugo+rx" includes="**/*"/>
  </target>

  <target name="reflect-mac-main" depends="expand-dist" description="==> reflect to main examples">
    <copy todir="${dbflute.basic.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.basic.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>

    <copy todir="${dbflute.spring.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.spring.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
  	
    <copy todir="${dbflute.mysql.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.mysql.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>

    <copy todir="${dbflute.multipledb.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.multipledb.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>

    <copy todir="${dbflute.teeda.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.teeda.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
  	
    <copy todir="${dbflute.sastruts.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.sastruts.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>

<!--
    <copy todir="${dbflute.ymir.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.ymir.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
    <copy todir="${dbflute.flexserver.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.flexserver.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
-->
<!--
    <copy todir="${dbflute.s2jdbc.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.s2jdbc.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
-->
  </target>

  <target name="reflect-mac-limit-basic" depends="expand-dist" description="==> reflect to basic example">
    <copy todir="${dbflute.basic.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.basic.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
  </target>

  <target name="reflect-mac-limit-mysql" depends="expand-dist" description="==> reflect to mysql example">
    <copy todir="${dbflute.mysql.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.mysql.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
  </target>

  <target name="reflect-mac-limit-spring" depends="expand-dist" description="==> reflect to spring example">
    <copy todir="${dbflute.spring.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.spring.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
  </target>

  <target name="reflect-mac-limit-multipledb" depends="expand-dist" description="==> reflect to multipledb example">
    <copy todir="${dbflute.multipledb.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.multipledb.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
  </target>

  <target name="reflect-mac-limit-pbasic" depends="expand-dist" description="==> reflect to test application">
    <copy todir="${dbflute.pbasic.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  	<chmod dir="${dbflute.pbasic.example.dir}/mydbflute/dbflute-${version}/ant/bin" perm="ugo+rx" includes="**/*"/>
  </target>

  <target name="reflect-win-main" depends="expand-dist" description="==> reflect to test application">
    <copy todir="${dbflute.nbasic.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
    <copy todir="${dbflute.oracle.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
    <copy todir="${dbflute.postgresql.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
    <copy todir="${dbflute.db2.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
    <copy todir="${dbflute.sqlserver.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
    <copy todir="${dbflute.msaccess.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
    <copy todir="${dbflute.noracle.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
    <copy todir="${dbflute.buri.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  </target>

  <target name="reflect-win-limit-basic" depends="expand-dist" description="==> reflect to test application">
    <copy todir="${dbflute.basic.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  </target>

  <target name="reflect-win-limit-nbasic" depends="expand-dist" description="==> reflect to nbasic example">
    <copy todir="${dbflute.nbasic.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  </target>

  <target name="reflect-win-limit-noracle" depends="expand-dist" description="==> reflect to noracle example">
    <copy todir="${dbflute.noracle.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  </target>

  <target name="reflect-win-limit-oracle" depends="expand-dist" description="==> reflect to oracle example">
    <copy todir="${dbflute.oracle.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  </target>

  <target name="reflect-win-limit-postgresql" depends="expand-dist" description="==> reflect to postgresql example">
    <copy todir="${dbflute.postgresql.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  </target>

  <target name="reflect-win-limit-sqlserver" depends="expand-dist" description="==> reflect to sqlserver example">
    <copy todir="${dbflute.sqlserver.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  </target>

  <target name="reflect-win-limit-buri" depends="expand-dist" description="==> reflect to buri example">
    <copy todir="${dbflute.buri.example.dir}/mydbflute/dbflute-${version}">
      <fileset dir="${dbflute.deploy.dir}"/>
    </copy>
  </target>
</project>
